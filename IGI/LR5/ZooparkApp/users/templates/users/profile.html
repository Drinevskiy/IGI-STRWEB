{% extends "zoopark/base.html" %}
{% load static %}

{% block title %}{{title}}{% endblock %}
{% block style %} 
    <link rel="stylesheet" href="{% static 'css/profile.css' %}">
{% endblock %}
{% block content %}
<h2>Профиль</h2>
<div class="user-card">
    <h3>{{ user.first_name }} {{ user.last_name }}</h3>
    <p>Ник: {{ user.username }}</p>
    <p>Email: {{ user.email }}</p>
    <p>Статус: {% if user.is_superuser %}Админ{% elif user.is_staff %}Сотрудник{% elif not user.is_staff and not user.is_admin %}Посетитель{% endif %}</p>
    <p>Телефон: {{ user.phone }}</p>
</div>
<pre>{{ text_calendar }}</pre>
<p>Часовой пояс: {{user_tz}}</p>
<p>{{today|date:"d/m/Y H:i:s O"}}</p>
<p>UTC:{{utc|date:"d/m/Y H:i:s O"}}</p>
{% if user.is_authenticated and not user.is_superuser and not user.is_staff %}
    <h2>Билеты</h2>
    <div class="ticket-cards-container">
        {% for ticket in tickets %}
            <div class="ticket-card">
                <h3>{{ ticket.date }}</h3>
                <ul>
                    {% if ticket.excursion %}<li>Экскурсия</li>{% endif %}
                    {% if ticket.feeding %}<li>Кормление</li>{% endif %}
                    {% if ticket.photosession %}<li>Фотосессия</li>{% endif %}
                    {% if not ticket.photosession and not ticket.feeding and not ticket.excursion %}<li>Стандартный</li>{% endif %}
                </ul>
                <p class="price">{{ ticket.cost }} рублей</p>
            </div>
        {% endfor %}
    </div>
{% endif %}
{% if user.is_authenticated and user.is_staff and not user.is_superuser %}
    <h2>Животные</h2>
    <table>
        <thead>
            <tr>
                <th>Фото</th>
                <th>Животное</th>
                <th>Описание</th>
                <th>Дата рождения</th>
                <th>Дата поступления</th>
                <th>Вид</th>
                <th>Семейство</th>
                <th>Континент</th>
                <th>Корм</th>
                <th>Суточное потребление корма</th>
                <th>Расписание кормления</th>
                <th>Вольер</th>
                <th>Водоем</th>
                <th>Отопление</th>
                <th>Количество животных</th>
            </tr>
        </thead>
        <tbody>
            {% for item in animals %}
            <tr>
                    <td><img src="{% if item.0.image %}{{ item.0.image.url }}{% else %}{% static 'media/images/no.jpg' %}{% endif %}" width=200px alt="{% static 'images/no.jpg' %}"></td>
                    <td>{{ item.0.name }}</td>
                    <td>{{ item.0.description }}</td>
                    <td>{{ item.0.date_of_birth }}</td>
                    <td>{{ item.0.date_of_receipt }}</td>
                    <td>{{ item.0.type.name }}</td>
                    <td>{{ item.0.family.name }}</td>
                    <td>{{ item.0.family.continent }}</td>
                    <td>{{ item.1|join:", " }}</td>
                    <td>{{ item.0.daily_norm }}</td>
                    <td>{{ item.0.feeding_schedule }}</td>
                    <td>{{ item.0.aviary.name }}</td>
                    <td>{% if item.0.aviary.reservoir %}+{% else %}-{% endif%}</td>
                    <td>{% if item.0.aviary.heating %}+{% else %}-{% endif%}</td>
                    <td>{{ item.2.num_animals }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
    <script>
        let tz = Intl.DateTimeFormat().resolvedOptions().timeZone;
        if (!tz) {
            tz = "UTC"
        }
        document.cookie = "mytz=" + tz + ";path=/";
    </script>
{% endif %}
{% endblock %}